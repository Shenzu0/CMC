<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Boutique de Vêtements, Bijoux et Accessoires pour Femmes à Calais - Petites et Grandes Tailles</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Découvrez notre boutique de vêtements, bijoux et accessoires pour femmes, située à Calais. Nous proposons une large gamme de tailles, petites et grandes tailles. Visitez-nous à Calais Nord pour trouver la tenue parfaite pour toute occasion.">
    <meta name="keywords" content="boutique vêtements femmes, bijoux femmes, accessoires femmes, grandes tailles, petites tailles, Calais, Calais Nord, mode féminine, shopping Calais">
    <meta name="author" content="CMC Mode">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Boutique de Vêtements, Bijoux et Accessoires pour Femmes à Calais - Petites et Grandes Tailles">
    <meta property="og:description" content="Découvrez notre boutique de vêtements, bijoux et accessoires pour femmes, située à Calais. Nous proposons une large gamme de tailles, petites et grandes tailles. Visitez-nous à Calais Nord pour trouver la tenue parfaite pour toute occasion.">
    <meta property="og:type" content="website">
    <meta property="og:locale" content="fr_FR">
    <meta property="og:site_name" content="CMC Mode">
    <meta property="og:see_also" content="https://www.facebook.com/people/CMC-Mode/100083366191144/">
    <meta property="business:contact_data:street_address" content="51 Rue de la Mer">
    <meta property="business:contact_data:locality" content="Calais">
    <meta property="business:contact_data:region" content="Hauts-de-France">
    <meta property="business:contact_data:postal_code" content="62100">
    <meta property="business:contact_data:country_name" content="France">
    <link rel="stylesheet" href="./css/navbar.css">
    <link rel="stylesheet" href="./css/index.css">
    <link href="https://fonts.googleapis.com/css2?family=General+Sans:wght@400;600&display=swap" rel="stylesheet">


</head>
<body>
    <header class="unique-navbar transparent" id="unique-navbar">
        <a href="index.html">
            <img src="mg2/6681c1660d9613fbf3097b52_28a8288e-5e38-4119-805b-f6eb28d25c1b-p-130x130q80.webp" alt="Logo CMC Mode" class="unique-navbar-logo" id="navbar-logo">
        </a>
        <nav class="burger-menu" id="burger-menu">
            <div></div>
            <div></div>
            <div></div>
        </nav>
        <nav class="close-menu-icon" id="close-menu-icon">
            <div></div>
            <div></div>
            <div></div>
        </nav>
        <nav class="unique-navbar-content" id="unique-navbar-content">
            <a href="index.html" class="nav-link">ACCUEIL</a>
            <a href="shop.html" class="nav-link">PRODUITS</a>
            <a href="about.html" class="nav-link">À PROPOS</a>
            <a href="contact.html" class="nav-link">CONTACT</a>
            <a href="faq.html" class="nav-link">FAQ</a>
            <a href="blog.html" class="nav-link">BLOG</a>
            <a href="#" class="nav-link" onclick="logout()">DÉCONNEXION</a>
        </nav>
    </header>
    <section class="hero hero background-cover">
        <h1>Découvrez Nos Nouvelles Collections</h1>
        <a href="shop.html" class="button heroButton">Voir les Nouveautés</a>
        <button class="edit-button" onclick="editBackgroundImage('hero')">Modifier Image de Fond</button>
        <input type="file" id="upload-hero-bg" class="upload-input" style="display: none;" accept="image/*" onchange="uploadBackgroundImage(event, 'hero')">
    </section>
    <section class="section">
        <h2>Nos Produits</h2>
        <p class="produits">Découvrez notre gamme de produits uniques et de haute qualité. Cliquez ci-dessous pour voir notre collection complète.</p>
        <div class="products-section" id="products-section">
            <!-- Les produits seront affichés ici -->
        </div>
        <button class="edit-button" onclick="openModal()">Ajouter un produit</button>
        <div class="button-container">
            <a href="shop.html" class="button">Voir plus</a>
        </div>
    </section>
    <section class="separator"></section>
    <section class="section section-about hero background-cover">
        <h2>À Propos de CMC MODE</h2>
        <p>Nous sommes là pour vous offrir une expérience de shopping unique et personnalisée. Découvrez nos valeurs ainsi que notre localisation.</p>
        <button class="edit-button" onclick="editBackgroundImage('about')">Modifier Image de Fond</button>
        <input type="file" id="upload-about-bg" class="upload-input" style="display: none;" accept="image/*" onchange="uploadBackgroundImage(event, 'about')">
        <div class="button-container">
            <a href="about.html" class="button">En savoir plus</a>
        </div>
    </section>
    <section class="separator"></section>
    <section class="section section-blog hero background-cover">
        <h2>Blog</h2>
        <p>Découvrez nos derniers articles de blog, des conseils mode aux dernières tendances.</p>
        <button class="edit-button" onclick="editBackgroundImage('blog')">Modifier Image de Fond</button>
        <input type="file" id="upload-blog-bg" class="upload-input" style="display: none;" accept="image/*" onchange="uploadBackgroundImage(event, 'blog')">
        <div class="button-container">
            <a href="blog.html" class="button">Accéder au Blog</a>
        </div>
    </section>
    <footer class="footer">
        <div class="footer-wrapper">
            <a href="index.html"><img src="mg2/6681c1660d9613fbf3097b52_28a8288e-5e38-4119-805b-f6eb28d25c1b-p-130x130q80.webp" alt="CMC MODE" class="footer-logo"></a>
            <div class="footer-links">
                <a href="./politiqueDonnées.html">Politique de données</a>
            </div>
            <div class="social-links">
                <a href="#"><img src="images/facebook-icon.svg" alt="Facebook"></a>
            </div>
        </div>
        <p class="bFoot">&copy; 2024 CMC MODE. Tous droits réservés.</p>
    </footer>

    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Ajouter un produit</h2>
            <input type="hidden" id="productId">
            <label for="title">Titre</label>
            <input type="text" id="title" placeholder="Titre du produit">
            <label for="description">Description</label>
            <textarea id="description" placeholder="Description du produit"></textarea>
            <label for="imageFile">Sélectionner une image</label>
            <input type="file" id="imageFile" accept="image/*">
            <button onclick="saveProduct()">Enregistrer</button>
        </div>
    </div>
    <script>
 document.addEventListener('DOMContentLoaded', function () {
    // Charger les vêtements depuis MySQL
    fetch('/api/vetements')
        .then(response => response.json())
        .then(vetements => {
            const productsSection = document.getElementById('products-section');
            vetements.forEach(vetement => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <img src="${vetement.image_url}" alt="${vetement.titre}" class="product-image" id="product-${vetement.id}">
                    <div class="product-info">
                        <div class="product-title">${vetement.titre}</div>
                        <div class="product-description">${vetement.description}</div>
                    </div>
                    <button class="edit-button" onclick="editProductImage('${vetement.id}')">Modifier l'image</button>
                    <input type="file" id="upload-product-${vetement.id}" class="upload-input" style="display: none;" accept="image/*" onchange="uploadImage(event, 'product-${vetement.id}')">
                `;
                productsSection.appendChild(productCard);
            });
        })
        .catch(error => console.error('Erreur lors du chargement des vêtements:', error));

    // Charger les images de fond au chargement de la page
    fetch('/get-background-images')
        .then(response => response.json())
        .then(data => {
            if (data.hero) {
                document.querySelector('.hero').style.backgroundImage = `url(${data.hero})`;
            }
            if (data.about) {
                document.querySelector('.section-about').style.backgroundImage = `url(${data.about})`;
            }
            if (data.blog) {
                document.querySelector('.section-blog').style.backgroundImage = `url(${data.blog})`;
            }
        })
        .catch(error => console.error('Erreur lors du chargement des images de fond:', error));

    // Fonction pour éditer l'image d'un vêtement
    function editProductImage(id) {
        const fileInput = document.getElementById(`upload-product-${id}`);
        fileInput.click();
    }

    // Fonction pour uploader une nouvelle image pour un vêtement
    function uploadImage(event, productId) {
        const file = event.target.files[0];
        const formData = new FormData();
        formData.append('image', file);
        formData.append('id', productId.replace('product-', ''));

        fetch('/upload-vetement-image', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById(productId).src = data.filePath;
            } else {
                alert('Échec du téléchargement de l\'image');
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Fonction pour éditer les images de fond
    function editBackgroundImage(section) {
        const fileInput = document.getElementById(`upload-${section}-bg`);
        fileInput.click();
    }

    // Fonction pour gérer l'upload des images de fond
    function uploadBackgroundImage(event, sectionId) {
        const file = event.target.files[0];
        const formData = new FormData();
        formData.append('image', file);
        formData.append('section', sectionId);

        fetch('/upload-background-image', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const section = document.querySelector(`.${sectionId}`);
                section.style.backgroundImage = `url(${data.filePath})`;
            } else {
                alert('Échec du téléchargement de l\'image');
            }
        })
        .catch(error => console.error('Error:', error));
    }

    // Vérification de la session de l'admin
    fetch('/check-session')
        .then(response => response.json())
        .then(data => {
            if (data.isAdmin) {
                document.body.classList.add('admin');
            } else {
                document.body.classList.remove('admin');
            }
        })
        .catch(error => console.error('Error checking session:', error));

    // Animation de la navbar lors du défilement
    window.addEventListener('scroll', function() {
        const navbar = document.getElementById('unique-navbar');
        const navbarContent = document.getElementById('unique-navbar-content');
        if (!navbarContent.classList.contains('active')) {
            if (window.scrollY > 50) {
                navbar.classList.remove('transparent');
                navbar.classList.add('solid');
            } else {
                navbar.classList.remove('solid');
                navbar.classList.add('transparent');
            }
        }
    });

    // Gestion du menu burger
    const burgerMenu = document.getElementById('burger-menu');
    const closeMenuIcon = document.getElementById('close-menu-icon');
    const navbarContent = document.getElementById('unique-navbar-content');

    function toggleMenu() {
        const isActive = navbarContent.classList.contains('active');
        navbarContent.classList.toggle('active', !isActive);
        burgerMenu.classList.toggle('active', !isActive);
        closeMenuIcon.classList.toggle('active', !isActive);
    }

    burgerMenu.addEventListener('click', toggleMenu);
    closeMenuIcon.addEventListener('click', toggleMenu);

    // Réinitialiser l'état du menu burger lors du redimensionnement
    window.addEventListener('resize', function () {
        if (window.innerWidth > 1050) {
            navbarContent.classList.remove('active');
            burgerMenu.classList.remove('active');
            closeMenuIcon.classList.remove('active');
        }
    });

    // Fonction pour ouvrir le modal d'ajout de produit
    function openModal(product = null) {
        const modal = document.getElementById('productModal');
        const modalTitle = document.getElementById('modalTitle');
        const isEditMode = !!product;
        modal.style.display = 'block';
        if (isEditMode) {
            document.getElementById('productId').value = product.id;
            document.getElementById('title').value = product.titre;
            document.getElementById('description').value = product.description;
            document.getElementById('imageFile').value = '';
            modalTitle.textContent = 'Modifier le produit';
        } else {
            modalTitle.textContent = 'Ajouter un produit';
            document.getElementById('productId').value = '';
            document.getElementById('title').value = '';
            document.getElementById('description').value = '';
            document.getElementById('imageFile').value = '';
        }
    }

    // Fonction pour fermer le modal
    function closeModal() {
        const modal = document.getElementById('productModal');
        modal.style.display = 'none';
    }

    // Fonction pour sauvegarder un produit
    async function saveProduct() {
        const productId = document.getElementById('productId').value;
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const imageFile = document.getElementById('imageFile').files[0];

        const formData = new FormData();
        formData.append('title', title);
        formData.append('description', description);
        formData.append('category', 'index'); // ou autre catégorie selon ta logique
        if (imageFile) {
            formData.append('image', imageFile);
        }

        const method = productId ? 'PUT' : 'POST';
        const url = productId ? `/api/products/${productId}` : '/api/products';

        await fetch(url, {
            method: method,
            body: formData
        })
        .catch(error => console.error('Erreur lors de la sauvegarde du produit:', error));

        closeModal();
        window.location.reload(); // Recharge la page pour afficher les modifications
    }

    // Fonction pour supprimer un produit
    async function deleteProduct(id) {
        await fetch(`/api/products/${id}`, { method: 'DELETE' });
        window.location.reload(); // Recharge la page pour afficher les modifications
    }
});
           // Animation on scroll
           const sections = document.querySelectorAll('.section');
            const options = {
                threshold: 0.2
            };
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, options);

            sections.forEach(section => {
                observer.observe(section);
            });
    </script>
</body>
</html>