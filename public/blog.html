    <!DOCTYPE html>
    <html lang="fr">

    <head>
        <meta charset="UTF-8">
        <title>Boutique de Vêtements, Bijoux et Accessoires pour Femmes à Calais - Petites et Grandes Tailles</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Découvrez notre boutique de vêtements, bijoux et accessoires pour femmes, située à Calais. Nous proposons une large gamme de tailles, petites et grandes tailles. Visitez-nous à Calais Nord pour trouver la tenue parfaite pour toute occasion.">
        <meta name="keywords" content="boutique vêtements femmes, bijoux femmes, accessoires femmes, grandes tailles, petites tailles, Calais, Calais Nord, mode féminine, shopping Calais">
        <meta name="author" content="CMC Mode">
        <meta name="robots" content="index, follow">
        <meta property="og:title" content="Boutique de Vêtements, Bijoux et Accessoires pour Femmes à Calais - Petites et Grandes Tailles">
        <meta property="og:description" content="Découvrez notre boutique de vêtements, bijoux et accessoires pour femmes, située à Calais. Nous proposons une large gamme de tailles, petites et grandes tailles. Visitez-nous à Calais Nord pour trouver la tenue parfaite pour toute occasion.">
        <meta property="og:url" content="https://www.votre-site.com">
        <meta property="og:image" content="https://www.votre-site.com/images/logo.png">
        <meta property="og:type" content="website">
        <meta property="og:locale" content="fr_FR">
        <meta property="og:site_name" content="CMC Mode">
        <meta property="og:see_also" content="https://www.facebook.com/people/CMC-Mode/100083366191144/">
        <meta property="business:contact_data:street_address" content="51 Rue de la Mer">
        <meta property="business:contact_data:locality" content="Calais">
        <meta property="business:contact_data:region" content="Hauts-de-France">
        <meta property="business:contact_data:postal_code" content="62100">
        <meta property="business:contact_data:country_name" content="France">
        <link href="https://fonts.googleapis.com/css2?family=General+Sans:wght@400;600&display=swap" rel="stylesheet">

        <link rel="stylesheet" href="./css/navbar.css">
        <link rel="stylesheet" href="./css/blog.css">
    </head>
    <body>
        <div class="unique-navbar transparent" id="unique-navbar">
            <a href="index.html"><img src="./mg2/6681c1660d9613fbf3097b52_28a8288e-5e38-4119-805b-f6eb28d25c1b-p-130x130q80.webp" alt="Logo" class="unique-navbar-logo" id="navbar-logo"></a>

            <div class="burger-menu" id="burger-menu">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div class="close-menu-icon" id="close-menu-icon">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <nav class="unique-navbar-content" id="unique-navbar-content">
                <a href="index.html" class="nav-link">ACCUEIL</a>
                <a href="shop.html" class="nav-link">PRODUITS</a>
                <a href="about.html" class="nav-link">À PROPOS</a>
                <a href="contact.html" class="nav-link">CONTACT</a>
                <a href="faq.html" class="nav-link">FAQ</a>
                <a href="blog.html" class="nav-link">BLOG</a>
                <a href="#" class="nav-link" onclick="logout()">DÉCONNEXION</a>
            </nav>
        </div>

        <div class="blog-header">
            <h1>Blog</h1>
            <p>Découvrez nos dernières actualités, tendances et inspirations</p>
        </div>
        <div class="section" id="articles-grid">
            <!-- Articles will be dynamically loaded here -->
        </div>

        <div class="admin-buttons" id="admin-buttons" style="display: none; justify-content: center;">
            <button onclick="openArticleModal()">Ajouter un article</button>
        </div>

        <!-- Modal pour l'article -->
        <div id="articleModal" class="modal">
            <div id="articleModalContent" class="modal-content">
                <span class="close" onclick="closeArticleModal()">&times;</span>
                <h2 id="articleModalTitle">Ajouter un article</h2>
                <input type="hidden" id="articleId">
                <label for="articleTitle">Titre</label>
                <input type="text" id="articleTitle" placeholder="Titre de l'article">
                <label for="articleContent">Contenu</label>
                <textarea id="articleContent" placeholder="Contenu de l'article"></textarea>
                <label for="articleImageFile">Sélectionner une image</label>
                <input type="file" id="articleImageFile">
                <span id="fileName">Aucun fichier n’a été sélectionné</span>
                <button onclick="saveArticle()">Enregistrer</button>
            </div>
        </div>

        <!-- Modal pour les commentaires -->
        <div id="commentModal" class="modal">
            <div id="commentModalContent" class="modal-content">
                <span class="close" onclick="closeCommentModal()">&times;</span>
                <h2 id="commentModalTitle">Ajouter un commentaire</h2>

                <!-- Section de connexion Google -->
                <div id="signin-section" style="display: block;">
                    <button id="signin-button">Connectez-vous avec Google</button>
                </div>

                <!-- Formulaire de commentaire, masqué tant que l'utilisateur n'est pas connecté -->
                <form id="commentForm" onsubmit="saveComment(event)" style="display: none;" novalidate>
                    <input type="hidden" id="commentArticleId" name="articleId">
                    
                    <!-- Champ pour le nom de l'utilisateur -->
                    <label for="commentName">Nom</label>
                    <input type="text" id="commentName" name="commentName" placeholder="Votre nom" required readonly>
                    
                    <!-- Champ pour le texte du commentaire -->
                    <label for="commentText">Commentaire</label>
                    <textarea id="commentText" name="commentText" placeholder="Votre commentaire" required></textarea>
                    
                    <!-- Bouton pour soumettre le commentaire -->
                    <button type="submit">Enregistrer</button>
                </form>
            </div>
        </div>


        <!-- Footer -->
        <footer class="footer">
            <div class="footer-wrapper">
                <a href="index.html"><img src="./mg2/6681c1660d9613fbf3097b52_28a8288e-5e38-4119-805b-f6eb28d25c1b-p-130x130q80.webp" alt="CMC MODE" class="footer-logo"></a>
                <div class="footer-links">
                    <a href="./politiqueDonnées.html">Politique de données</a>
                </div>
                <div class="social-links">
                    <a href="#"><img src="images/facebook-icon.svg" alt="Facebook"></a>
                </div>
            </div>
            <p class="bFoot">&copy; 2024 CMC MODE. Tous droits réservés.</p>
        </footer>
        <script>
            let isEditMode = false;
            let isAdmin = false;
            let googleUser = null; // Variable globale pour stocker l'utilisateur Google connecté
    
 // Fonction pour charger les articles et les commentaires
async function fetchArticles() {
    try {
        const response = await fetch('/api/articles');
        const articles = await response.json();
        console.log('Articles récupérés:', articles); // Ajout de log pour vérifier les articles récupérés

        const articlesGrid = document.getElementById('articles-grid');
        articlesGrid.innerHTML = ''; // Vider la grille avant de charger de nouveaux articles

        articles.forEach(article => {
            // Vérifie si l'article a des commentaires. Si non, utilise un tableau vide.
            const comments = article.comments || []; // Si undefined, initialiser à []

            console.log('Commentaires de l\'article:', comments); // Ajout de log pour vérifier les commentaires de chaque article
            
            const articleCard = document.createElement('div');
            articleCard.className = 'post fade-in light-effect';
            articleCard.id = `article-${article.id}`;

            articleCard.innerHTML = `
                <h2 class="post-title">${article.titre}</h2>
                <img src="${article.image_url}" alt="${article.titre}" class="post-image">
                <div class="post-content">${article.contenu}</div>
                ${isAdmin ? `
                <div class="admin-buttons">
                    <button onclick="deleteArticle(${article.id})">Supprimer</button>
                </div>
                ` : ''}
                <div class="comment-section">
                    <h3>Commentaires</h3>
                    ${comments.length > 0 ? comments.map(comment => `
                        <div class="comment">
                            <p><strong>${comment.name || 'Anonyme'}</strong>: ${comment.commentaire}</p>
                            ${isAdmin ? `<button onclick="deleteComment(${article.id}, ${comment.id})">Supprimer</button>` : ''}
                        </div>
                    `).join('') : '<p>Aucun commentaire pour cet article.</p>'}
                    <button onclick="openCommentModal(${article.id})">Ajouter un commentaire</button>
                </div>
            `;
            articlesGrid.appendChild(articleCard);
        });


    
                    // Activer les animations de fade-in si nécessaire
                    handleScroll();
                } catch (error) {
                    console.error('Failed to fetch articles', error);
                }
            }
    
            function handleScroll() {
                const fadeIns = document.querySelectorAll('.fade-in');
    
                fadeIns.forEach(element => {
                    if (element.getBoundingClientRect().top < window.innerHeight) {
                        element.classList.add('fade-in-visible');
                    }
                });
            }
    
            window.addEventListener('scroll', handleScroll);
            window.onload = fetchArticles;
    
            function openArticleModal(article = null) {
                const modal = document.getElementById('articleModal');
                const modalTitle = document.getElementById('articleModalTitle');
                isEditMode = !!article;
                modal.style.display = 'block';
                if (isEditMode) {
                    document.getElementById('articleId').value = article.id;
                    document.getElementById('articleTitle').value = article.title;
                    document.getElementById('articleDescription').value = article.description;
                    document.getElementById('articleImageFile').value = '';
                    modalTitle.textContent = 'Modifier l\'article';
                } else {
                    modalTitle.textContent = 'Ajouter un article';
                    document.getElementById('articleId').value = '';
                    document.getElementById('articleTitle').value = '';
                    document.getElementById('articleDescription').value = '';
                    document.getElementById('articleImageFile').value = '';
                }
            }
    
            function closeArticleModal() {
                const modal = document.getElementById('articleModal');
                modal.style.display = 'none';
            }
    
            // Fonction pour ouvrir le modal de commentaire
            function openCommentModal(articleId) {
                console.log('Ouverture du modal pour l\'article avec ID:', articleId);
    
                const modal = document.getElementById('commentModal');
                document.getElementById('commentArticleId').value = articleId;  // Assigner l'ID de l'article
    
                modal.style.display = 'block';
    
                // Vérifiez si l'utilisateur est connecté avec Google
                checkGoogleAuthStatus();
            }
    
            // Fonction pour fermer le modal de commentaire
            function closeCommentModal() {
                const modal = document.getElementById('commentModal');
                modal.style.display = 'none';
            }
    
            // Fonction pour gérer la réponse de Google Sign-In
            function handleCredentialResponse(response) {
                console.log("Google Sign-In réponse reçue:", response);
    
                const token = response.credential;
    
                if (!token) {
                    console.error("Aucun token reçu de Google Sign-In.");
                    return;
                }
    
                // Envoyer le token au serveur pour le vérifier
                fetch('/api/verify-google-token', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ token })
                })
                .then(res => res.json())
                .then(data => {
                    console.log("Réponse du serveur pour la vérification Google:", data);
    
                    if (data.success) {
                        googleUser = data.user;
    
                        // Masquer le bouton de connexion et afficher le formulaire de commentaire
                        document.getElementById('signin-section').style.display = 'none';
                        document.getElementById('commentForm').style.display = 'block';
                        
                        // Préremplir le nom de l'utilisateur connecté
                        document.getElementById('commentName').value = googleUser.name;
    
                        console.log("Authentification réussie. Nom d'utilisateur:", googleUser.name);
                    } else {
                        console.error('Échec de l\'authentification Google:', data.error);
                    }
                })
                .catch(err => console.error('Erreur d\'authentification Google:', err));
            }
    
            // Vérifier si l'utilisateur est déjà connecté avec Google
            function checkGoogleAuthStatus() {
                const signinButton = document.getElementById('signin-button');
                const commentForm = document.getElementById('commentForm');
                
                // Vérifiez si les éléments existent avant de tenter de modifier leur style
                if (!signinButton || !commentForm) {
                    console.error("Les éléments 'signin-button' ou 'commentForm' sont introuvables dans le DOM.");
                    return;  // Arrêter l'exécution si les éléments ne sont pas trouvés
                }
    
                if (googleUser) {
                    signinButton.style.display = 'none';
                    commentForm.style.display = 'block';
                } else {
                    signinButton.style.display = 'block';
                    commentForm.style.display = 'none';
                }
            }
    
            // Fonction pour sauvegarder un article
            async function saveArticle() {
                const articleId = document.getElementById('articleId').value;
                const titre = document.getElementById('articleTitle').value;
                const contenu = document.getElementById('articleContent').value;
                const imageFile = document.getElementById('articleImageFile').files[0];
    
                const formData = new FormData();
                formData.append('titre', titre);
                formData.append('contenu', contenu);
                if (imageFile) {
                    formData.append('image', imageFile);
                }
    
                try {
                    if (isEditMode) {
                        await fetch(`/api/articles/${articleId}`, {
                            method: 'PUT',
                            body: formData
                        });
                    } else {
                        await fetch('/api/articles', {
                            method: 'POST',
                            body: formData
                        });
                    }
                    closeArticleModal();
                    fetchArticles();
                } catch (error) {
                    console.error('Failed to save article', error);
                }
            }
    
            async function deleteArticle(id) {
                try {
                    await fetch(`/api/articles/${id}`, {
                        method: 'DELETE'
                    });
                    fetchArticles();
                } catch (error) {
                    console.error('Failed to delete article', error);
                }
            }
    
            // Fonction pour sauvegarder le commentaire
            async function saveComment(event) {
                event.preventDefault(); // Empêche le rechargement de la page
    
                const articleId = document.getElementById('commentArticleId').value;
                const name = document.getElementById('commentName').value.trim(); // Assurez-vous que 'name' est défini
                const text = document.getElementById('commentText').value.trim(); // Assurez-vous que 'text' est défini
    
                if (!name || !text) {
                    alert('Veuillez remplir tous les champs.');
                    return;
                }
    
                try {
                    const response = await fetch(`/api/articles/${articleId}/comments`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ name, text }) // Envoyez les valeurs correctement
                    });
    
                    if (!response.ok) {
                        throw new Error('Erreur lors de l\'ajout du commentaire.');
                    }
    
                    console.log('Commentaire ajouté avec succès');
                    document.getElementById('commentText').value = ''; // Réinitialisation du champ commentaire
                    closeCommentModal(); // Fermer le modal après la soumission réussie
                    fetchArticles(); // Rafraîchir les articles et les commentaires
                } catch (error) {
                    console.error('Échec de l\'enregistrement du commentaire', error);
                }
            }
    
            async function deleteComment(articleId, commentId) {
                try {
                    await fetch(`/api/articles/${articleId}/comments/${commentId}`, {
                        method: 'DELETE'
                    });
                    fetchArticles();
                } catch (error) {
                    console.error('Failed to delete comment', error);
                }
            }
    
            // Initialiser Google Sign-In
            window.addEventListener('load', function() {
                console.log("Initialisation de Google Sign-In...");
    
                google.accounts.id.initialize({
                    client_id: '815007391612-1pssr0jnhe9oaqtsvjlalq2p3uut312l.apps.googleusercontent.com', // Votre ID client Google
                    callback: handleCredentialResponse
                });
    
                google.accounts.id.renderButton(
                    document.getElementById('signin-button'),
                    { theme: 'outline', size: 'large' }
                );
    
                console.log("Bouton Google Sign-In rendu.");
    
                // Vérifiez l'état de connexion de Google après le rendu du bouton
                checkGoogleAuthStatus();
            });
    
            window.onclick = function(event) {
                const articleModal = document.getElementById('articleModal');
                const commentModal = document.getElementById('commentModal');
                if (event.target == articleModal) {
                    articleModal.style.display = 'none';
                }
                if (event.target == commentModal) {
                    commentModal.style.display = 'none';
                }
            }
    
            window.addEventListener('scroll', function() {
                const navbar = document.getElementById('unique-navbar');
                const navbarContent = document.getElementById('unique-navbar-content');
                if (!navbarContent.classList.contains('active')) {
                    if (window.scrollY > 50) {
                        navbar.classList.remove('transparent');
                        navbar.classList.add('solid');
                    } else {
                        navbar.classList.remove('solid');
                        navbar.classList.add('transparent');
                    }
                }
            });
    
            // Gestion du menu burger
            const burgerMenu = document.getElementById('burger-menu');
            const closeMenuIcon = document.getElementById('close-menu-icon');
            const navbarContent = document.getElementById('unique-navbar-content');
        
            function toggleMenu() {
                const isActive = navbarContent.classList.contains('active');
                navbarContent.classList.toggle('active', !isActive);
                burgerMenu.classList.toggle('active', !isActive);
                closeMenuIcon.classList.toggle('active', !isActive);
            }
        
            burgerMenu.addEventListener('click', toggleMenu);
            closeMenuIcon.addEventListener('click', toggleMenu);
        
            // Réinitialiser l'état du menu burger lors du redimensionnement
            window.addEventListener('resize', function () {
                if (window.innerWidth > 1050) {
                    navbarContent.classList.remove('active');
                    burgerMenu.classList.remove('active');
                    closeMenuIcon.classList.remove('active');
                }
            });
    
            document.getElementById('articleImageFile').addEventListener('change', function() {
                const fileName = this.files.length ? this.files[0].name : 'Aucun fichier n’a été sélectionné';
                document.getElementById('fileName').textContent = fileName;
            });

            async function checkAdminStatus() {
    try {
        const response = await fetch('/check-session'); // Crée une route /check-session dans ton backend
        const data = await response.json();
        if (data.isAdmin) {
            isAdmin = true;
            document.getElementById('admin-buttons').style.display = 'flex'; // Affiche le bouton "Ajouter un article"
        }
    } catch (error) {
        console.error('Erreur lors de la vérification de l\'état admin:', error);
    }
}
window.onload = function() {
    fetchArticles();
    checkAdminStatus(); // Vérifie si l'utilisateur est un admin
}


        </script>
    
        <!-- Google Sign-In Script -->
        <script src="https://accounts.google.com/gsi/client" async defer></script>

    </body>
    </html>